"use strict";(self.webpackChunkinsta_clone=self.webpackChunkinsta_clone||[]).push([[417],{6393:function(e,n,t){t.d(n,{Z:function(){return b}});var s=t(2791),r=t(1087),o=t(184);function a(e){var n=e.username;return(0,o.jsx)("div",{className:"flex border-b border-gray-primary h-4 p-4 py-8",children:(0,o.jsx)("div",{className:"flex items-center",children:(0,o.jsxs)(r.rU,{to:"/p/".concat(n),className:"flex items-center",children:[(0,o.jsx)("img",{className:"rounded-full h-8 w-8 flex mr-3",src:"/images/avatars/".concat(n,".jpg"),alt:"".concat(n," profile")}),(0,o.jsx)("p",{className:"font-bold",children:n})]})})})}function c(e){var n=e.src,t=e.caption;return(0,o.jsx)("img",{src:n,alt:t})}var l=t(4165),i=t(5861),u=t(9439),d=t(2303),m=t(6307);function p(e){var n=e.docId,t=e.totalLikes,r=e.likedPhoto,a=e.handleFocus,c=(0,s.useContext)(m.Z).user,p=null===c||void 0===c?void 0:c.uid,x=(0,s.useState)(r),f=(0,u.Z)(x,2),h=f[0],v=f[1],j=(0,s.useState)(t),b=(0,u.Z)(j,2),g=b[0],y=b[1],N=(0,s.useContext)(d.Z),k=N.firebase,w=N.FieldValue,Z=function(){var e=(0,i.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=5;break}return v((function(e){return!e})),e.next=4,k.firestore().collection("photos").doc(n).update({likes:h?w.arrayRemove(p):w.arrayUnion(p)});case 4:y((function(e){return h?e-1:e+1}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"flex justify-between p-4",children:(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsx)("svg",{onClick:Z,onKeyDown:function(e){"Enter"===e.key&&Z()},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,className:"w-8 mr-4 select-none ".concat(p?"cursor-pointer":"cursor-auto","     focus:outline-none ").concat(h?"fill-red text-red-primary":"text-black-light"),children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,o.jsx)("svg",{onClick:a,onKeyDown:function(e){"Enter"===e.key&&a()},className:"w-8 text-black-light select-none ".concat(p?"cursor-pointer":"cursor-auto"," focus:outline-none"),xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})]})}),(0,o.jsx)("div",{className:"p-4 py-0",children:(0,o.jsx)("p",{className:"font-bold",children:"".concat(g,1===g?" like":" likes")})})]})}function x(e){var n=e.caption,t=e.username;return(0,o.jsxs)("div",{className:"p-4 pt-2 pb-0",children:[(0,o.jsx)("span",{className:"mr-1 pr-2 font-bold",children:t}),(0,o.jsx)("span",{children:n})]})}var f=t(7346),h=t(3433);function v(e){var n=e.docId,t=e.comments,r=e.setComments,a=e.commentInput,c=(0,s.useState)(""),l=(0,u.Z)(c,2),i=l[0],p=l[1],x=(0,s.useContext)(d.Z),f=x.firebase,v=x.FieldValue,j=(0,s.useContext)(m.Z).user.displayName,b=function(e){return e.preventDefault(),r([{displayName:j,comment:i}].concat((0,h.Z)(t))),p(""),f.firestore().collection("photos").doc(n).update({comments:v.arrayUnion({displayName:j,comment:i})})};return(0,o.jsxs)("div",{className:"flex items-center max-w-full",children:[(0,o.jsx)("img",{className:"flex-none rounded-full h-8 w-8 mx-3",src:"/images/avatars/".concat(j,".jpg"),alt:"".concat(j," profile")}),(0,o.jsx)("div",{className:"grow border-l border-t border-gray-primary rounded-l-md",children:(0,o.jsxs)("form",{className:"flex justify-between pl-0 pr-5",method:"POST",onSubmit:function(e){return i.length>=1?b(e):e.preventDefault()},children:[(0,o.jsx)("input",{"aria-label":"Add a comment",autoComplete:"off",className:"text-sm text-gray-base w-full mr-3 py-5 px-4 rounded-md",type:"text",name:"add-comment",placeholder:"Add a comment...",value:i,onChange:function(e){var n=e.target;return p(n.value)},ref:a}),(0,o.jsx)("button",{className:"text-sm font-bold text-blue-medium ".concat(!i&&"opacity-25"),type:"button",disabled:i.length<1,onClick:b,children:"Post"})]})})]})}function j(e){var n=e.docId,t=e.comments,a=e.posted,c=e.commentInput,l=e.expandAll,i=(0,s.useContext)(m.Z).user,d=null===i||void 0===i?void 0:i.uid,p=(0,s.useState)(t),x=(0,u.Z)(p,2),h=x[0],j=x[1],b=(0,s.useState)(l?h.length:3),g=(0,u.Z)(b,2),y=g[0],N=g[1];function k(){N((function(e){return e+3}))}return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"p-4 pt-1 pb-4",children:[h.length>=3&&y<h.length&&!l&&(0,o.jsx)("button",{className:"text-sm text-gray-base mb-1 cursor-pointer",type:"button",onClick:k,onKeyDown:function(e){"Enter"===e.key&&k()},children:"View more comments"}),h.slice(0,y).reverse().map((function(e){return(0,o.jsxs)("p",{className:"mb-1",children:[(0,o.jsx)(r.rU,{to:"/p/".concat(e.displayName),children:(0,o.jsx)("span",{className:"mr-1 font-bold",children:e.displayName})}),(0,o.jsx)("span",{children:e.comment})]},"".concat(e.comment,"-").concat(e.displayName))})),(0,o.jsxs)("p",{className:"text-gray-base uppercase text-xs mt-2",children:["Posted ",(0,f.Z)(a,new Date)," ago"]})]}),d&&(0,o.jsx)(v,{docId:n,comments:h,setComments:j,commentInput:c})]})}function b(e){var n=e.content,t=e.expandAllComments,r=(0,s.useRef)(null);return(0,o.jsxs)("div",{className:"rounded col-span-4 border bg-white border-gray-primary mb-12",children:[(0,o.jsx)(a,{username:n.username}),(0,o.jsx)(c,{src:n.imageSrc,caption:n.caption}),(0,o.jsx)(p,{docId:n.docId,totalLikes:n.likes.length,likedPhoto:n.userLikedPhoto,handleFocus:function(){return r.current.focus()}}),(0,o.jsx)(x,{caption:n.caption,username:n.username}),(0,o.jsx)(j,{docId:n.docId,comments:n.comments.reverse(),posted:n.dateCreated,commentInput:r,expandAll:t})]})}},6594:function(e,n,t){t.r(n),t.d(n,{default:function(){return h}});var s=t(4165),r=t(5861),o=t(9439),a=t(7689),c=t(2791),l=t(7606),i=t(8155),u=t(9353),d=t(6307),m=t(2579),p=(t(5862),t(6393)),x=t(184);function f(e){var n=e.photo;return(0,x.jsx)("div",{className:"container col-span-2 ml-2",children:n?(0,x.jsx)("div",{className:"mx-12",children:(0,x.jsx)(p.Z,{content:n,expandAllComments:!0})}):(0,x.jsx)(m.Z,{count:4,width:640,height:500,className:"block mb-5"})})}function h(){var e=(0,a.UO)(),n=(e.username,e.id),t=(0,c.useState)(null),m=(0,o.Z)(t,2),p=m[0],h=m[1],v=(0,a.s0)(),j=(0,c.useContext)(d.Z).user;return(0,c.useEffect)((function(){function e(){return(e=(0,r.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.Oi)(n,null===j||void 0===j?void 0:j.uid);case 2:(t=e.sent).length>0?h(t[0]):v(i.Hi);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[p,v]),null!==p&&void 0!==p&&p.photoId?(0,x.jsxs)("div",{className:"bg-gray-background",children:[(0,x.jsx)(u.Z,{}),(0,x.jsx)("div",{className:"mx-auto max-w-screen-lg",children:(0,x.jsx)(f,{photo:p})})]}):null}}}]);
//# sourceMappingURL=417.5be18e4b.chunk.js.map